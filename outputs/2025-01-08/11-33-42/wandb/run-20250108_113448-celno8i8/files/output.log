LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name                   | Type                         | Params | Mode
--------------------------------------------------------------------------------
0 | sparse_encoder         | SparseContextEncoder         | 231 K  | train
1 | mamba_layer            | MambaLayer                   | 330 K  | train
2 | high_level_model       | HighLevelInteractionModel    | 1.2 M  | train
3 | lane_probability_model | LaneAwareProbabilityLearning | 347 K  | train
4 | laplace_decoder        | MultimodalLaplaceDecoder     | 516    | train
--------------------------------------------------------------------------------
2.1 M     Trainable params
0         Non-trainable params
2.1 M     Total params
8.515     Total estimated model params size (MB)
90        Modules in train mode
0         Modules in eval mode
Sanity Checking: |                                                                                                                                                                        | 0/? [00:00<?, ?it/s]
Error executing job with overrides: ['+task=train']
Traceback (most recent call last):
  File "/home/user/Traj-LLM/imjaegyun/Traj-LLM/train.py", line 26, in <module>
    main()
  File "/home/user/anaconda3/envs/im_jg/lib/python3.9/site-packages/hydra/main.py", line 94, in decorated_main
    _run_hydra(
  File "/home/user/anaconda3/envs/im_jg/lib/python3.9/site-packages/hydra/_internal/utils.py", line 394, in _run_hydra
    _run_app(
  File "/home/user/anaconda3/envs/im_jg/lib/python3.9/site-packages/hydra/_internal/utils.py", line 457, in _run_app
    run_and_report(
  File "/home/user/anaconda3/envs/im_jg/lib/python3.9/site-packages/hydra/_internal/utils.py", line 223, in run_and_report
    raise ex
  File "/home/user/anaconda3/envs/im_jg/lib/python3.9/site-packages/hydra/_internal/utils.py", line 220, in run_and_report
    return func()
  File "/home/user/anaconda3/envs/im_jg/lib/python3.9/site-packages/hydra/_internal/utils.py", line 458, in <lambda>
    lambda: hydra.run(
  File "/home/user/anaconda3/envs/im_jg/lib/python3.9/site-packages/hydra/_internal/hydra.py", line 132, in run
    _ = ret.return_value
  File "/home/user/anaconda3/envs/im_jg/lib/python3.9/site-packages/hydra/core/utils.py", line 260, in return_value
    raise self._return_value
  File "/home/user/anaconda3/envs/im_jg/lib/python3.9/site-packages/hydra/core/utils.py", line 186, in run_job
    ret.return_value = task_function(task_cfg)
  File "/home/user/Traj-LLM/imjaegyun/Traj-LLM/train.py", line 15, in main
    train_main(config)  # train_main에 DictConfig 전달
  File "/home/user/Traj-LLM/imjaegyun/Traj-LLM/train/train_model.py", line 192, in train_main
    trainer.fit(model, train_loader, val_loader)
  File "/home/user/anaconda3/envs/im_jg/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 539, in fit
    call._call_and_handle_interrupt(
  File "/home/user/anaconda3/envs/im_jg/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 47, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/user/anaconda3/envs/im_jg/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 575, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/home/user/anaconda3/envs/im_jg/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 982, in _run
    results = self._run_stage()
  File "/home/user/anaconda3/envs/im_jg/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 1024, in _run_stage
    self._run_sanity_check()
  File "/home/user/anaconda3/envs/im_jg/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 1053, in _run_sanity_check
    val_loop.run()
  File "/home/user/anaconda3/envs/im_jg/lib/python3.9/site-packages/pytorch_lightning/loops/utilities.py", line 179, in _decorator
    return loop_run(self, *args, **kwargs)
  File "/home/user/anaconda3/envs/im_jg/lib/python3.9/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 137, in run
    batch, batch_idx, dataloader_idx = next(data_fetcher)
  File "/home/user/anaconda3/envs/im_jg/lib/python3.9/site-packages/pytorch_lightning/loops/fetchers.py", line 134, in __next__
    batch = super().__next__()
  File "/home/user/anaconda3/envs/im_jg/lib/python3.9/site-packages/pytorch_lightning/loops/fetchers.py", line 61, in __next__
    batch = next(self.iterator)
  File "/home/user/anaconda3/envs/im_jg/lib/python3.9/site-packages/pytorch_lightning/utilities/combined_loader.py", line 341, in __next__
    out = next(self._iterator)
  File "/home/user/anaconda3/envs/im_jg/lib/python3.9/site-packages/pytorch_lightning/utilities/combined_loader.py", line 142, in __next__
    out = next(self.iterators[0])
  File "/home/user/anaconda3/envs/im_jg/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 630, in __next__
    data = self._next_data()
  File "/home/user/anaconda3/envs/im_jg/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1345, in _next_data
    return self._process_data(data)
  File "/home/user/anaconda3/envs/im_jg/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1371, in _process_data
    data.reraise()
  File "/home/user/anaconda3/envs/im_jg/lib/python3.9/site-packages/torch/_utils.py", line 694, in reraise
    raise exception
KeyError: Caught KeyError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/home/user/anaconda3/envs/im_jg/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 308, in _worker_loop
    data = fetcher.fetch(index)
  File "/home/user/anaconda3/envs/im_jg/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 51, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/user/anaconda3/envs/im_jg/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 51, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/user/Traj-LLM/imjaegyun/Traj-LLM/data/nuscenes_data_loader.py", line 83, in __getitem__
    raise e
  File "/home/user/Traj-LLM/imjaegyun/Traj-LLM/data/nuscenes_data_loader.py", line 60, in __getitem__
    raise KeyError(f"'instance_token' not found in sample: {sample}")
KeyError: "'instance_token' not found in sample: {'token': '559b34089780446a9b16fd439e3d409a', 'timestamp': 1537297613899749, 'prev': '', 'next': '32f74b8958ea4d79b3c69f6ae603f9ac', 'scene_token': '65cfdc10a42e499ea704c617e077afe0', 'data': {'RADAR_FRONT': 'c0b2857af13346f8938c388447f0d1ed', 'RADAR_FRONT_LEFT': 'e1611c31f46b427a84b4d7a3f1f7b668', 'RADAR_FRONT_RIGHT': '18e916dd1a874124814577ec45be8043', 'RADAR_BACK_LEFT': 'a2d5d35a494c49b1bb300e1a2d7d5664', 'RADAR_BACK_RIGHT': '8a3b6bd7682144ada01b0b5aaa299ad6', 'LIDAR_TOP': 'bd29a8414ccf4ad0ab46d30ff2c94dd4', 'CAM_FRONT': '1eecf77debdb4ea5946d5ac70dca31a4', 'CAM_FRONT_RIGHT': '6d18a134adec48e2a0ddf94c70b43031', 'CAM_BACK_RIGHT': 'e44eeda0dac2494ea67bf3c0f8a39473', 'CAM_BACK': 'b6327cf281284709ae45c92eb0436579', 'CAM_BACK_LEFT': '7b4d0fc0b54b4a77a87c9a7f8af3e0f0', 'CAM_FRONT_LEFT': '8d502fb7f04c4b85939d9ecdafaa1884'}, 'anns': ['435dbbc3ddfc44f1bd1f31e4226183bc', 'b1a6d62bb6a646238c4f5264a614bbf9', '410caef5635f40ed942e748ec47371be', '82841f659e944f9e8f16d0451c3ca852', 'c1f03bf011684d89aef7d80be5beb821', '28575568b471462eb3b1a33472621460', 'be81543d34e146aabb6b9ea78b1e61e2', 'edccc095f29b4816a04c97224ffd0e2b', '7a87724fa8194b9987b0821e85cadddf', '5cb237253cfe41748801fb4454038124', '935d6a7df130409ab26658116dd8a31c', '8701c2a7cf324b1ca25ebc1ec3d610f6', '1c04a863fb0a4d7a805deca81d472f3a', '859861deb8f14697ae8120f5fcafd953', '584a4f2aa6a74379b1bae889f66e74f6', '2dc48aa1096f4ee38ecee0a0214b176f', 'ad574a1d177b43f7a0412c986834054e', '0e6955786a484719bfbdec959125b074', '1a6b238c0eb94230a2a6fa81bdba028b', 'c4624fddd477444084ada3ee4e8929e8', 'fe529325d5594064ba8808e93392439e', 'e8c4797f411140c08ea9cc31c9e76bcc', '4d0ffc254e7742e2963daf84cbce129d', '5fd6e98d53e447bcba1f469b8535fe71', '8a00b007fea54cc6954662db0e613a1c', 'aca822d393e74c168b6a8ecd9530f660', '8c61651a2878478f905f6b5dfc7ab283', 'f060ac5cd7e048fca48d91cfb35abbf3', '0677cdac849a4fb3b6ac443a25a17af8', '33438083ac1840558567e15621232ae6', 'a7586d188df44910b45f05da95729390', 'b88db46d5514435d8dcbd266b1c733ef', 'cee7c035975d4f909b9a36556283bbba', '0ab1265b829544cfb7d1557e2ca33ab8', '97eab37a7a3342bba5cab57c7991c146', '5fccb7cca5cd4703ad4e3eabfda689a6', '57771bd0521f46daa71fd75342bd5637', 'c201a9220f15465dafa94bc0979eae25', '4e651424d0034984930a9d60f9e032df', '0e0bd507ac164741bcd2074623f7a98f', '4be7717627b44ed785396b185721f94d', '6af271c5b4f24572bd50de5121173b03', 'f25331ebb0054598800ade6133c1e167', 'ae4a4fc86ba04b5db364dec81881aaf3', '929259bcb5764453ae179c3bb3d8b0ba', 'd6c188e6c42a472bb91fe2faf8ca03bb', '914a1c6f367947e58c7864e9439686eb', '1f4abb1837cd440d83b7c715612a139a', '3aac6180366b422c8d356f7ce64fb56a', '205082f9e1e74fd3bab30347318e047c', 'be9632b240b3468ba820009c0ad04ecd', '09cc30aa3cef468caf4795f5becc58b7', 'e5ad2abe63854afb81a1ca8831f9df4b', '14e34a15836447ae8b1b24b856875700', '4717c6060cba45be81bce93a206f5315']}"
